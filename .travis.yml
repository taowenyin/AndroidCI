language: android
android:
  components:
  - tools
  - platform-tools
  - build-tools-26.0.1
  - android-25
  - extra-google-google_play_services
  - extra-google-m2repository
  - extra-android-m2repository
  - addon-google_apis-google-24
before_install:
- openssl aes-256-cbc -K $encrypted_f38811b06a7a_key -iv $encrypted_f38811b06a7a_iv
  -in keys/taowenyin.jks.enc -out keys/taowenyin.jks -d
- mkdir "$ANDROID_HOME/licenses" || true
- echo -e "\n8933bad161af4178b1185d1a37fbf41ea5269c55" > "$ANDROID_HOME/licenses/android-sdk-license"
before_script:
- chmod +x gradlew
script:
- "./gradlew assembleRelease"
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
    - $HOME/.android/build-cache
deploy:
  provider: releases
  api_key:
    secure: jHI1x1vYMFdUE8i9VwMQIPBIQXCywhX4p9a7nl2CYKzShcyUeDDw0NMr+DPgBoyGhNsyJvDlfofcEDPdZI0Yd8QRNWeLKPE5dtWu6DI7qxo/kwLd+HxmVkoF2Dk2+TT25sgYwTo1X/LOvtrWOto99tVHjNZMzkNUm4/9PPRpmaQ+BhgeklT340ma2DI14BJZ2jaeR6ThCMB9Izh6DTNh+TozqhalvYGxNrihqDBcBWp81WLTfzs9mmaujyek7Qw5iAn0yJZG5NSlJZAcR4rINaL4jUtL75DrZbJtUh6V+0hjAXOje4fuURuNVOcWTJg188WZSFy1qze/MgpupGVhfEHsrnqEKtXZVi5s3MUVez1H36Eu6G9dmR8biuPaVt95NCKoZdP64sZAKvpiszJHsdmWoQsCFtgEXg/ULV5fkiMftIM/P4pq/o9rsLkdi/fUmnUqCCAO0IHtDQJzYSJVuiuoxpLu3ggGeRMTDf1a9o/hbSczxklnE3Tgze5MsqTfvgetpYOB1+6U2Q41Bf0TCukdJ+YBtBavVhiAzB5xpJ5spWgWQQdH1+zwtL+PKX8Y76jDXZZ2U8PGoVhEk0ukKoIOUmB9ZJpnQDFdFLGf58UazQm2Hgj8DvEOqxC0RWbAMO20Bc0x8al5ldIaWu3y5jZVfIKeQQEn2JOaXM7u1Aw=
  file: app/build/outputs/apk/app-release.apk
  skip_cleanup: true
  on:
    tags: true
    repo: taowenyin/AndroidCI
